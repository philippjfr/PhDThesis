%!TEX root = ../PhDthesis.tex
\chapter{General Discussion}

In this thesis we presented a series of models of the primary visual
cortex to integrate our understanding of how different cell classes
and their synaptic connections can give rise to a robust, yet dynamic
circuit to extract and encode visual features and statistics of the
world and replicate a wide range of contextual modulation
phenomena. Additionally we presented a workflow for analyzing complex,
high-dimensional datasets easily and reproducibly.

One of the major goals set out in this thesis was to begin integrating
across the various levels of description that David Marr laid out in
his seminal work on vision \citep{Marr1982}. While individual models
describe individual phenomena very well and we have gathered a huge
data about the cortex from increasingly complex and precise
experimental studies, the theoretical frameworks of computation in the
cortex has for the large part been unchanged since the early days of
neuroscience when concepts like the receptive and association field
were first developed. This stands in stark contrast to the field of
machine learning, which recently has made huge advances in the area of
deep neural networks, based loosely on the architecture of the
cortex. The models developed as part of this model closely resemble
the architecture of these networks but also model the complexities of
the cortical circuit to far greater detail. Integrative models are
essential to begin to make sense of the large amounts of data that is
being generated by modern experimental techniques and place them into
a overall framework that explains mechanistically how low-level
network interactions give rise to behavior through computation and
learning.

On this basis we have proposed a series of models, which let us relate
the process of learning to the actual computations performed by the
cortex. Unlike many other models, integrative models such as those
proposed here can mechanistically explain how different cell classes
and synaptic connections interact at an algorithmic and
implementational level to give rise to a developed circuit, which
exhibits many of the features observed in the visual cortex. This
provides a significant step towards a general computational theory of
the cortex.

At the same time it is important to note the limitations of the
modeling approach employed in this thesis. The models used here are
particularly suited towards studying network level phenomena and lower
level phenomena at the level of individual neurons are largely
ignored. This allows simulating large cortical networks and studying
the response of the network to naturalistic inputs but also means that
lower level phenomena are ignored. This approach should be seen as
complementary to both lower and higher level modeling frameworks,
however it is my conviction that it is the appropriate level at which
the computational principles of the cortex can be studied, ignoring
details at the level of individual neurons but at the same time not
completely ignoring inter-neuronal interactions. As such it is meant as
a first order approximation of cortical function and it is highly
probable that the more detailed biophysical interactions at the level
of individual synapses and spiking neurons will be required to fully
explain cortical computation.

The main aim of these models then is to identify a number of canonical
computations by the cortex that explain a wide range of phenomena. In
the past both divisive gain control \citep{Carandini2012} and
homeostasis \citep{Marder2006} have been identified as two core
computations and previous developmental models have shown that these
mechanisms are sufficient to explain the robust, yet adaptive
organization of the cortex into feature maps \citep{Stevens2013}. In
this thesis we will make the case for an additional canonical
computation, that allows the brain to extract the statistics of the
visual inputs in order to optimize coding and aid the brain in making
sense of its environment and extracting the important information by
appropriately using feedforward information and statistical inference.

\section{A reproducible workflow for the analysis of complex datasets}

As part of this thesis we have described a general workflow for the
analysis of complex datasets using the HoloViews and Lancet Python
libraries. Every single non-diagrammatic plot in this thesis has been
generated using the HoloViews library and is available with a
completely reproducible record of how the figures were generated
available at \url{thesis.philippjfr.com}. These tools in themselves
provide a major contribution to greatly improve the productivity of
researchers while ensuring, almost as a byproduct, that each stage of
the research is completely reproducible. This starts with launching
instances of a model either locally or on a cluster, monitoring and
collecting those results and finally generating complex figures and
analyses with minimal amounts of code. The HoloViews library in
particular is now a popular open-source project and is in use in a
wide range of scientific disciplines, has been used in publications
and for teaching materials. As a core designer and developer of the
library, this work represents one of the most fundamental
contributions of this thesis and will improve productivity and
reproducibility far beyond the field of neuroscience.

\section{Spatial Calibration}

One of the first steps in approaching the hugely complex problem of
modeling the neuronal interactions that give rise to development of a
cortical circuit was to adapt existing developmental models in such a
way that they would more closely reflect the real interactions between
cell classes and synaptic connections in the cortex. Therefore the
SCAL model was introduced with spatially calibrated extents allowing
us to relate known anatomical measurements directly to the model and
replicate various measurements protocols, which are highly dependent
on the spatial profiles of connections to the distances in the
model. Additionally the model was switched from subtractive to
divisive inhibition, as divisive contrast gain-control has long been
identified as a canonical computation in the cortex
\citep{Carandini2012}. These small modification were sufficient to
account for contrast dependent size tuning shifts, suggesting that the
shift toward larger size preferences at low contrasts could almost
completely be accounted for by changes in the gain of the center and
surround mechanisms as suggested by \cite{Cavanaugh2002}. Additionally
the spatially calibrated model provides a foundation to study effects
that depend on the precise spatial configuration of the stimuli.

Furthermore through careful evaluation of the literature we have shown
that the extent of a certain classes of inhibitory neurons is
sufficient to account for the effective Mexican hat connectivity in
the model, that is required for robust self-organization into an
orientation map, while even longer range excitatory projections
provide the true long-range interactions in the circuit.

\section{Canonical Computations}

The spatial calibration was however only a first step, making it
possible to relate anatomy to function in the cortex and begin
integrating the vast amount of information that has been gathered in
the pursuit of understanding the organization of the cortical
circuit. Our main interest was in establishing core mechanisms in the
interactions of excitatory and inhibitory neurons in the cortex to
determine their role in cortical computations and if possible relate
them back to the neural subtypes and connections that mediate
them. Here we will identify these mechanisms, summarize the findings
and make the case that they perform a number of canonical computations
in the cortex that exist across sensory modalities and perhaps even
non-sensory areas.

\subsection{Feedforward inhibition}

Specifically we discovered that the known properties of PV neurons
make this class of large, feedforward and recurrently driven
interneurons particularly well suited towards driving the organization
of V1 into a smooth orientation map. By changing the properties of the
inhibition we were also able to show that sub- or supra-linear
integration by this cell class could result in disruptions to the
development, which may reflect the changes in visual processing that
have been observed in pathologies as diverse as autism, schizophrenia
and Parkinson's.

Our analysis also suggested that the feedforward driven PV neurons are
perfectly positioned to provide feedforward inhibition gating how much
afferent drive arrives in the cortex thereby controlling the effective
contrast gain of the circuit. While a model cannot directly confirm
that PV+ neurons serve the same functions in macaque visual cortex as
has been suggested in mouse cortex, the analysis does demonstrate that
feedforward, gain control is an essential property to account for
robust and stable organization and contrast dependent size tuning
shifts. On that basis we predict that PV interneurons in higher
mammals mediate global, feedforward driven contrast gain control, as
suggested in a number of studies in mouse V1 \citep{Ma2010,
  Atallah2012, Wilson2012, Nienborg2013}.

At the same time the PV-immunoreactive interneurons is a very broad
classification, which may exhibit considerable
heterogeneity. Specifically clutch cells, which are primarily enriched
in layer 4 likely have very different properties than large basket
cells, which can cover a large area. Indeed there is some evidence
that clutch cells are involved in providing the pull component in a
push-pull model of orientation selectivity. This may also explain the
ongoing debate about the extent to which this cell class is tuned for
orientation, with studies in different layers and species coming to
very different conclusions \citep{Cardin2007, Ma2011, Hofer2011}.

The major contribution of this model in the context of the thesis is
in establishing a robust model of orientation map development that is
spatially calibrated and has distinct excitatory and inhibitory
populations. The model produces orientation maps, which match
biological maps very closely \citep{Kaschube2010, Stevens2013}, with
high stability and selectivity and provides a framework to build
surround modulation models on. The strong divisive gain control
afforded by the inhibitory population also accounts for a contrast
dependent size tuning shifts which matches experiments both in
diversity and magnitude. As such it provides a solid basis to build
further models on.

In a wider context we suggest that feedforward gain control is a
fundamentally important mechanism for computation in the cortex. It
allows gating the amount of feedforward drive that is received by an
area in the cortex, providing a powerful mechanism to control the
balance between feedforward and recurrent processing that can be
modulated in a task dependent manner, controls development and
fundamentally shapes the organization of the cortex. The PV
interneuron population provides an excellent candidate to mediate this
suppression and experimentalists should work towards precisely
characterizing their properties across species to establish whether
their function is evolutionarily conserved, which would provide a good
indicator of how central they are to cortical computations.

\subsection{Feedback inhibition}

While feedforward inhibition responds very quickly to afferent input,
surround modulation operates over longer spatial and temporal
scales. The other major contribution of this thesis is in proposing a
general cortical circuit to mediate long-range interactions via slowly
integrating long-range connections, which mediate both direct
facilitation and di-synaptic suppression through a secondary
interneuron population. After a detailed review of the literature we
concluded that the Sst population, which receive extensive recurrent
inputs from lateral and feedback connections in layer 2/3 integrate
over long spatial scales \citep{Xu2009, Adesnik2012, Nienborg2013}
provide an excellent candidate to mediate long-range and feature
specific surround suppression. Additionally we have shown that an
accelerating response function on the lateral connections between the
excitatory cells and this inhibitory population is sufficient to
account for the contrast dependent changes from surround suppression
to facilitation that have been well characterized in the brain
\citep{Levitt1997, Polat1998, Dragoi2000, Wang2009}.

The full proposed circuit therefore accounts for a huge range of
response properties, developmental processes and surround modulation
effects using a fairly small set of mechanisms and can be used to
inform future experiments. In particular our the modeling suggests a
strong role for a secondary laterally driven inhibitory interneuron
population to provide long-range surround suppression, that is
distinct from the much faster, feedforward driven inhibition we have
attributed to the PV population.

Whether feedforward and feedback inhibition can be directly mapped
onto the PV- and Sst- expressing inhibitory cell classes will have to
be experimentally validated, however we suggest that feedback
inhibition is another core computation performed by the
cortex. Specifically we suggest that it allows placing the information
arriving via the feedforward pathways into context, allowing the
cortex to compute visual saliency. Additionally feedback inhibition
can decorrelate neurons allowing the feedforward responses to extract
a maximally independent and therefore sparse representation of the
inputs. However unlike many previous proposals we suggest that instead
of being hard-coded this suppression emerges as a consequences of the
fact that the statistics captures the statistics its sensory inputs in
lateral connections.

\section{Roles of lateral connectivity}

In the model the inhibitory populations themselves do not exhibit any
long-range or feature specific connectivity patterns. Long-range
interactions are predominantly driven by long-range excitatory
connections spanning several visual degrees and across multiple
hypercolumns as has been extensively established in the literature
\citep{Weliky1995, Bair2003}. Furthermore detailed analysis of the
connectivity patterns of these long-range connections established not
only that they link iso-orientation columns but also that they are
able to capture the co-occurrence statistics of both simple synthetic
stimuli and more complex natural images. On that basis we suggest that
the long-range patchy connections in layer 2/3 of the cortex merely
reflect the co-linearity by connecting iso-orientation regions, but
that they also capture more subtle properties of natural image
statistics such as co-circularity and other Gestalt rules of visual
perception and are therefore directly responsible for mediating
contextual effects such as contour facilitation, iso-orientation
suppression and pop-out.

In order to understand what the lateral connections were actually
representing this thesis contributes a number of analyses based on
existing methods for analyzing the co-occurrence statistics in natural
images established put forward by \cite{Geisler2001} and
\cite{Perrinet2015}. By adapting these analyses to extract the
co-occurrence statistics from the weight matrices in the model we were
able to conclusively demonstrate that lateral connections could
capture the co-occurrence statistics of the visual environment. On
this basis we predict that lateral connections across the cortex
capture higher-order statistics of the inputs, providing a statistical
model of the relationship between lower level feature detectors.

Additionally this work predicts that the rearing environment of an
animal strongly affect the organization of lateral connections in the
cortex, which could explain species differences in the anisotropy of
lateral connectivity. To test this possibility directly the model was
trained on both image datasets drawn from nature and from treeshrew
cages and were able to show highly significant differences in the
anisotropy of the connectivity. This suggests that the differences in
lateral connection isotropy between treeshrews \citep{Bosking1997} and
macaques \citep{Angelucci2002} could at least partially be explained
by the differences in rearing environments of the
animals. Experimentalists should test for this possibility explicitly
because it could significantly influence the properties of surround
modulation.

Establishing to what extent these connections are involved in higher
order processing is still under heavy debate. However based on the
results from the model we can draw several specific conclusions. First
of all their spatial scale is sufficient to capture interactions
beyond the size of the receptive field of most neurons, suggesting
they are at least involved in processing contextual influences from
the extra-classical surround. The extent to which they are involved in
these processes probably depends on the species and cortical
eccentricity, as receptive field sizes vary considerably across
species and at least in some species they can cover a significant
portion of the visual space \citep{Bosking1997}. However they are
neither fast nor extensive enough to account for the full range of
surround effects.

While these results are very specific to the field of vision, lateral
connections are found extensively across the cortex suggesting they
play a crucial role in cortical computation. Indeed there is a growing
amount of evidence suggesting that statistically optimal surround
suppression can improve figure ground separation and computation of
visual salience \citep{Coen-Cagli2013, Coen2015}. One of the core hypothesis
put forward in this thesis is that lateral connections provide a
general mechanism for the cortex to generate a statistical model of
the inputs to a particular cortical area, which the cortex uses
dynamically for a number of crucial computations, depending on the
sensory and behavioral context. Specifically through interaction with
the inhibitory interneurons they can aid in discrimination through
suppression of similar stimuli and detection of surprising stimuli,
which are not well captured by their statistical model and are
therefore unsuppressed. At the same time they provide a substrate for
the cortex to make statistical inferences, when feedforward input is
not sufficient resulting in effects like contour completion.

\section{Future Work}

The models, analyses and tools presented in this thesis cover a huge
range and individually provide major contributions to our
understanding of cortical circuits and computation. However perhaps
more importantly they lay the groundwork to study a wide range of
phenomena in the cortex. In this section we will lay out how the
models could be extended to study phenomena reaching well beyond the
primary visual cortex and suggest specific avenues for future studies
that were outside of the scope of this project.

\subsection{Linking statistics to perception}

A major component of the work presented here was in demonstrating how
lateral connections could mediate a number of surround modulation
effects that have been observed in the primary visual cortex. Secondly
through analyzing the connectivity between neurons with different
feature preferences we also showed that they were able to accurately
capture the statistics of the developmental training patterns. As an
obvious next step future experiments should provide detailed analyses
to what extent differences in the visual statistics during rearing can
affect surround modulation in the adult. This will link all the ideas
proposed in this thesis back up, linking low-level mechanistic circuit
interactions to learning and learning to behavior. As far as we are
aware this would represent the first fully integrative model able to
link low-level processes to high level behavior with an overarching
theory of the computations performed by the cortex.

One particular avenue for future experiments would be to generate
stimuli, which either match or do not match the statistical
dependencies encoded in the lateral connections, demonstrating
significant differences in surround modulation. This would provide
concrete predictions, which could be tested by rearing animals in
environments with significantly different visual statistics and
confirming that surround modulation is indeed affected.

\subsection{Interactions between cell classes}

In the current model interactions between the inhibitory cell classes
were largely ignored. However based on experiments it is thought that
PV and Sst neurons strongly inhibit each other. Through some
exploratory work it was observed that Sst suppression of PV neurons
could lead to interesting dynamics where they would essentially
disinhibit the local excitatory population, reducing the amount of
contrast gain-control and therefore reducing the effective integration
area. This is a very interesting avenue to pursue as this could
effectively model some of the features of visual attention, where
feedforward drive is increased relative to the lateral processing,
effectively mirroring the effects of increasing the contrast.

\subsection{Sparsity of connections}

One major avenue of work that was developed for this thesis but
ultimately was not used was developing a sparse matrix implementation
of the core algorithms used to simulate the model. This work has since
been extended to work on GPUs enabling significant speedups in
simulating large models. This work will not only allow for the
implementation of much larger models but also make the existing models
more realistic. Specifically it is known that V1 neurons in layer 4
receive afferent input from just a small number of afferent
projections and lateral connections are highly sparse in their pattern
of innvervation.

Simulating sparsity could therefore improve the realism of the models
and at the same time improve a variety of properties in the
model. Specifically initial exploration of sprouting and retraction
algorithms for controlling the sparsity of synaptic connections
demonstrated that orientation map development could proceed with just
a small fraction of the connections that are simulated in the dense
version and the resulting models were considerably more stable because
the afferent weights could not easily move around. This provides more
realism for the simulation of orientation map development.

More interestingly however letting the lateral connections develop
sparsely could match the known time-course of the emergence of patchy
connections in the cortex very well \citep{Ruthazer1996}, emerging in
concert with the orientation map and then slowly clustering in
increasingly distant iso-orientation patches. This would also remove
the need to threshold the weights after development achieving the
sparse distribution of connections required for strong surround
modulation without an artificial mechanism.

\subsection{Complex cells}

One major limitation of models presented in this thesis is that they
are purely a model of simple cells, even though long-range connections
and surround modulation effects are generally ascribed to layer 2/3,
which has both simple and complex cells. This may have considerable
implications for the results offered here, since complex cells trade
off precise positional information for invariance. If lateral
connections primarily link complex cells it is possible that there is
not enough spatial precision to accurately capture the co-circular
properties of visual scenes over the spatial scales that they are
known to project over. Additionally the current set of models suffers
from disruptions in the orientation map caused by phase reversals,
which would be eliminated by the introduction of complex cells
\citep{Antolik2010}.

An extension of the models presented here, which explicitly models
layer 4 and layer 2/3 and therefore develops orientation invariance
would therefore be an excellent avenue of further study and make
concrete predictions about the differences in lateral connectivity
linking simple and complex cells improving our understanding of what
purpose they serve.

\subsection{Tuning diversity}

For reasons of computational and conceptual tractability the models
introduced as part of this thesis have approximated the incredible
diversity in LGN receptive fields by focusing on the average responses
of neurons. However there are complex interactions between spatial
frequency preferences and orientation selectivity that could therefore
not be sufficiently explored. Modeling the full diversity of spatial
frequency filters would provide a better account of the diversity of
spatial and orientation tuning diversity in primary visual
cortex. Additionally very little work has been done to begin to
understand how spatial frequency maps and relate to other feature
maps, which would go some way towards providing an understanding of
how the cortex is able to map features varying in multiple dimensions
onto the 2D surface of the cortex.

Having such a model would also make it easier to relate the statistics
across datasets with significantly different spatial frequency
distributions, which has proved problematic when extracting the
natural image statistics from the lateral connectivity.

\subsection{Temporal responses}

While significant effort was put into spatially calibrating the models
presented in this thesis, it only has a very coarse model of the
temporal properties of neuronal responses. Even though these
characteristics were not explicitly considered the stereotypical
response of the model neurons bears close resemblance to the
peri-stimulus time histogram (PSTH) profiles that have been measured
in experiments, followed by strong suppression and a period of
settling reflecting the modulatory inputs to the neuron. Incorporating
a more realistic model of the time-course of neuronal responses by
applying some of the proposals set out in \cite{Stevens2016}, such as
a finer temporal resolution, latency scatter, and distance dependent
delays, could be used to study a wide range of phenomena.

Specifically combining models of different cell classes and the large
spatial spread of lateral connections could be used to explain the
spatio-temporal properties of the VSD and optical imaging
techniques. Additionally precisely characterizing the speed of
propagation could help in disentangling the role of lateral and
feedback connections in contextual modulation.

\subsection{Modeling different sensory areas}

As we have emphasized throughout this thesis the mechanisms that we
have identified in the models presented in this thesis underlie
canonical computations, which are not in any way specific to V1 or
even the visual pathway in general. The organization of both receptive
fields in the afferent connections and association fields in the
lateral connections is an emergent phenomenon driven by the statistics
of the inputs. It would therefore be of great interest to move beyond
just primary visual cortex and begin modeling both later stages in the
visual processing hierarchy and other cortical areas such as those
devoted to auditory or somatosensory cortex or even motor areas to
understand to what extent these mechanisms are truly general.

Modeling other sensory cortices in this way may shed light on the
organization and computational principles behind other sensory
areas. This is particularly interesting because while visual
neuroscience has been extensively characterized other sensory areas
such as auditory or somatosensory cortex are not nearly as well
characterized. A lot could therefore be learned about the role of
lateral connections in learning co-occurrence statistics between
auditory frequencies or whisker activations in rodent barrel
cortex. If learning feedforward and feedback inhibition and learning
of co-occurrence statistics are indeed general phenomena preserved
across the cortex the model should be able to predict the organization
of lateral connections in all these areas.

Furthermore modeling higher level sensory areas such as V2, V4 or MT
could shed light on the kinds of computations they are involved in by
decoding the higher-order correlations embedded in their
connectivity. This is particularly important because many hierarchical
models of vision ignore recurrent and feedback processing entirely in
favor of a simpler feedforward arrangement, which ignores a lot of
the complexity and models the cortical hierarchy as a static circuit,
ignoring context or task dependent modulation of neuronal
responses. This could have wide ranging consequences even for modern
machine learning approaches, which have generally avoided these
complexities.

\subsection{Cortical feedback}

Modeling higher level sensory areas such as V2 also opens up the
possibility to start modeling feedback projections to V1, which will
be central to coming a comprehensive model of primary visual cortex
and cortical computation in general. Both lateral connections and
feedback projections have the potential to capture, represent and
transmit higher-order statistical relationships in the world and at
least according to some theories can represent both prediction and
error signals \citep{Rao1999, Spratling2011}. Understanding how
higher-level areas communicate contextual information to lower level
areas to perform statistical inference and rapidly identify surprising
or novel stimuli is one of the major theoretical problems facing
neuroscience and the integrative approach taken by the family of
models presented here provide one of the best chances to begin
understanding at a mechanistic level how different cortical areas
interact.

To begin modeling these interactions the architecture laid out here
could be stacked and connections between the higher and lower levels
allowed to develop based on the usual Hebbian learning rules. Once
such a model has been set up comparing the feedback connections to the
known feedback connections could be used to validate the models and
the analyses developed as part of this thesis could be used to the
statistical relationships in the feedback connections, which would go
a long way towards understanding what these connections are doing from
a computational perspective.

\subsection{Neuromodulation of visuo-cortical information processing}

One of the original aims when developing the models that were
presented as part of this thesis was to develop a circuit, which would
allow for realistic modulation of specific neural subtypes and
connections. In particular the models are well suited to investigate
how the circuit can be dynamically modulated for task specific
demands, e.g. to model attentional modulation effects.

Specifically the existence of individual populations of inhibitory
neurons and a real long-range excitatory network could be used to
investigate how different neuromodulatory inputs to the cortex affect
the balance between feedforward and recurrent processing. In
particular it is hypothesized that cholinergic and adrenergic
neuromodulators are associated with attentional modulation.

One particular target of interest for further investigation is the
role of cholinergic inputs from the basal forebrain in mediating
attentional effects. Currently there are two main competing theories
of how cholinergic inputs to the cortex alters circuit dynamics,
outlined in the review by \cite{Thiele2013}. The first has been around
for at least two decades and suggests that cholinergic release
increases the feedforward drive and indiscriminately disrupts
intracortical processing. Recent evidence on the other seems to
contradict this hypothesis as a gross simplification pointing out that
different intracortical circuits are affected heterogeneously,
suggesting that while feedforward drive may be increased, layer 4
spiny cell firing is decreased, leading to weak inputs being filtered
out, while Sst-ir cell firing is also up-regulated indicating some
similarity between cholinergic modulation and the regular processing
taking place within the circuit under high contrast.

In order to test these hypothesis they could be be put to the test
through specific and well defined manipulations to the LESPI
model. The most basic manipulation would involve increasing
thalamocortical drive and reducing the strength of lateral excitatory
connections in the cortex, shifting the balance of the circuit towards
feedforward processing. Additionally more specific modulations could
be applied by suppressing the Pv-ir neurons and the Sst-ir neuron
activation function steepened. Overall this should shift the circuit
towards a regime akin to the processing that occurs under
high-contrast, reducing spatial and contextual integration in favor of
more accurately representing feedforward input \citep{Roberts2005,
  Roberts2008a, Roberts2008b}.
